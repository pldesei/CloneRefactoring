(startLine=54 endLine=85 srcPath=/root/Projects/org.eclipse.emfFilter/373/org.eclipse.emf/plugins/org.eclipse.emf.mapping.ecore2ecore.editor/src/org/eclipse/emf/mapping/ecore2ecore/action/AddInputRootAction.java)
  protected Collection<?> getTopsToAdd()
  {
    Collection<Object> objects = new ArrayList<Object>();

    ViewerFilter viewerFilter = new ViewerFilter()
    {
      @Override
      public boolean select(Viewer viewer, Object parentElement, Object element)
      {
         return !(element instanceof IFile) || "ecore".equals(((IFile)element).getFileExtension());  //$NON-NLS-1$
      }
    };
    final IFile[] files = WorkspaceResourceDialog.openFileSelection(
      workbenchPart.getSite().getShell(), 
      null, 
      Ecore2EcoreEditorPlugin.INSTANCE.getString("_UI_SelectInputEcoreModels_label"), //$NON-NLS-1$
      true, 
      null, 
      Collections.singletonList(viewerFilter));
        
    if (files.length > 0)
    {
      for (int i = 0; i < files.length; i++)
      {
        objects.addAll(((Ecore2EcoreEditor)workbenchPart).getEditingDomain().getResourceSet().getResource(
          URI.createPlatformResourceURI(files[i].getFullPath().toString(), true),
          true).getContents());
      }
    }

    return objects;
  }

