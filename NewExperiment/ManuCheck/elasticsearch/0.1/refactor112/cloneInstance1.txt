(startLine=85 endLine=117 srcPath=/root/NewExperiment/elasticsearchFilter/00797/src/main/java/org/elasticsearch/index/fielddata/plain/IntArrayIndexFieldData.java)
    public IntArrayAtomicFieldData loadDirect(AtomicReaderContext context) throws Exception {
        AtomicReader reader = context.reader();
        Terms terms = reader.terms(getFieldNames().indexName());
        if (terms == null) {
            return IntArrayAtomicFieldData.EMPTY;
        }
        // TODO: how can we guess the number of terms? numerics end up creating more terms per value...
        final TIntArrayList values = new TIntArrayList();

        values.add(0); // first "t" indicates null value
        OrdinalsBuilder builder = new OrdinalsBuilder(terms, reader.maxDoc());
        try {
            BytesRefIterator iter = builder.buildFromTerms(builder.wrapNumeric32Bit(terms.iterator(null)), reader.getLiveDocs());
            BytesRef term;
            while ((term = iter.next()) != null) {
                values.add(NumericUtils.prefixCodedToInt(term));
            }
            Ordinals build = builder.build(fieldDataType.getSettings());
            return build(reader, fieldDataType, builder, build, new BuilderIntegers() {
                @Override
                public int get(int index) {
                    return values.get(index);
                }

                @Override
                public int[] toArray() {
                    return values.toArray();
                }
            });
        } finally {
            builder.close();
        }
    }

