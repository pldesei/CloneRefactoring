(startLine=196 endLine=221 srcPath=/root/NewExperiment/elasticsearchFilter/00914/src/main/java/org/elasticsearch/percolator/QueryCollector.java)
        public void collect(int doc) throws IOException {
            BytesRef uid = values.getValue(doc);
            if (uid == null) {
                return;
            }
            Text id = new BytesText(Uid.idFromUid(uid));
            Query query = queries.get(id);
            if (query == null) {
                // log???
                return;
            }
            // run the query
            try {
                collector.reset();
                searcher.search(query, collector);
                if (collector.exists()) {
                    if (!limit || counter < size) {
                        matches.add(id);
                        scores.add(scorer.score());
                    }
                    counter++;
                }
            } catch (IOException e) {
                logger.warn("[" + id + "] failed to execute query", e);
            }
        }

