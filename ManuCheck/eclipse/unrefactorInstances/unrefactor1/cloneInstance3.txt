(startLine=121 endLine=133 srcPath=/root/Projects/eclipse.jdt.coreFilter/39/eclipse.jdt.core/org.eclipse.jdt.compiler.apt.tests/src/org/eclipse/jdt/compiler/apt/tests/ModelTests.java)
    private void internalTest(JavaCompiler compiler, String processorClass) throws IOException {
        System.clearProperty(processorClass);
        File targetFolder = TestUtils.concatPath(BatchTestUtils.getSrcFolderName(), "targets", "model");
        BatchTestUtils.copyResources("targets/model", targetFolder);

        List<String> options = new ArrayList<String>();
        options.add("-A" + processorClass);
        BatchTestUtils.compileTree(compiler, options, targetFolder);

        // If it succeeded, the processor will have set this property to "succeeded";
        // if not, it will set it to an error value.
        assertEquals("succeeded", System.getProperty(processorClass));
    }

