(startLine=133 endLine=158 srcPath=/home/ubuntu/luceneFilter/912/lucene/lucene/src/test/org/apache/lucene/util/TestFieldCacheSanityChecker.java)
  public void testInsanity2() throws IOException {
    FieldCache cache = FieldCache.DEFAULT;
    cache.purgeAllCaches();

    cache.getTerms(readerA, "theString");
    cache.getTerms(readerB, "theString");
    cache.getTerms(readerX, "theString");

    cache.getBytes(readerX, "theByte");


    // // // 

    Insanity[] insanity = 
      FieldCacheSanityChecker.checkSanity(cache.getCacheEntries());
    
    assertEquals("wrong number of cache errors", 1, insanity.length);
    assertEquals("wrong type of cache error", 
                 InsanityType.SUBREADER,
                 insanity[0].getType());
    assertEquals("wrong number of entries in cache error", 3,
                 insanity[0].getCacheEntries().length);

    // we expect bad things, don't let tearDown complain about them
    cache.purgeAllCaches();
  }

