(startLine=72 endLine=87 srcPath=/home/ubuntu/guavaFilter/720/guava/guava-tests/test/com/google/common/util/concurrent/AbstractIdleServiceTest.java)
    public void testStop_failed() throws Exception {
      final Exception exception = new Exception("deliberate");
      AbstractIdleService service = new DefaultService() {
        @Override protected void shutDown() throws Exception {
          throw exception;
        }
      };
      service.startAndWait();
      try {
        service.stopAndWait();
        fail();
      } catch (RuntimeException e) {
        assertSame(exception, e.getCause());
      }
      assertEquals(Service.State.FAILED, service.state());
    }

