(startLine=122 endLine=151 srcPath=/root/Projects/elasticsearchFilter/1061/elasticsearch/src/main/java/org/elasticsearch/percolator/QueryCollector.java)
        public void collect(int doc) throws IOException {
            spare.hash = values.getValueHashed(doc, spare.bytes);
            Query query = queries.get(spare);
            if (query == null) {
                // log???
                return;
            }
            // run the query
            try {
                collector.reset();
                if (context.highlight() != null) {
                    context.parsedQuery(new ParsedQuery(query, ImmutableMap.<String, Filter>of()));
                    context.hitContext().cache().clear();
                }

                searcher.search(query, collector);
                if (collector.exists()) {
                    if (!limit || counter < size) {
                        matches.add(values.makeSafe(spare.bytes));
                        if (context.highlight() != null) {
                            highlightPhase.hitExecute(context, context.hitContext());
                            hls.add(context.hitContext().hit().getHighlightFields());
                        }
                    }
                    counter++;
                }
            } catch (IOException e) {
                logger.warn("[" + spare.bytes.utf8ToString() + "] failed to execute query", e);
            }
        }

