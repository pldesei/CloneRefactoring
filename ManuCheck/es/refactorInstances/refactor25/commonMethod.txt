(startLine=296 endLine=309 srcPath=/root/Projects/elasticsearchFilter/1474/elasticsearch/src/main/java/org/elasticsearch/index/search/geo/GeoDistance.java)
        @Override public double calculate(double targetLatitude, double targetLongitude) {
            // TODO: we might want to normalize longitude as we did in LatLng...
            double longitudeDifference = targetLongitude - sourceLongitude;
            double c = Math.toRadians(90D - targetLatitude);
            double factor = (cosA * Math.cos(c)) + (sinA * Math.sin(c) * Math.cos(Math.toRadians(longitudeDifference)));

            if (factor < -1D) {
                return Math.PI * earthRadius;
            } else if (factor >= 1D) {
                return 0;
            } else {
                return Math.acos(factor) * earthRadius;
            }
        }

